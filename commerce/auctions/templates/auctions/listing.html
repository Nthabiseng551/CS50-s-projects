{% extends "auctions/layout.html" %}

{% block body %}

        <h1>{{ listing.title}} : {{ listing.timestamp}} : {{ listing.price.bid }}</h1>
        <h2>Comments</h2>
        {% if user.is_authenticated %}
                {% if owner and listing.active == "yes" %}
                <form action="{% url 'close' listing_id=listing.id %}" method="POST">
                        {% csrf_token %}
                        <button class="btn btn-primary btn-lg btn-block" id = "close" type="submit">Close auction</button>
                </form>
                {% endif%}
                {% if watchlist %}
                        <form action="{% url 'remove' listing_id=listing.id %}" method="POST">
                                {% csrf_token %}
                                <button class="btn btn-primary btn-lg btn-block" id = "remove" type="submit">Remove from watchlist</button>
                        </form>
                {% else %}
                        <form action="{% url 'add' listing_id=listing.id %}" method="POST">
                                {% csrf_token %}
                                <button class="btn btn-primary btn-lg btn-block" id ="add" type="submit">Add to watchlist</button>
                        </form>
                {% endif %}

                <h2>Comments</h2>
                <form action="{% url 'comment' listing_id=listing.id %}" method="POST">
                        {% csrf_token %}
                        <input name="comment" type="text" placeholder="Type your comment here">
                        <button class="btn btn-primary btn-sm" id ="comment" type="submit">Post comment</button>
                </form>

                <h2>Bids</h2>
                <form action="{% url 'bid' listing_id=listing.id %}" method="POST">
                        {% csrf_token %}
                        <input name="bid" type="number" placeholder="Bid">
                        <button class="btn btn-primary btn-sm" id ="bid" type="submit">Place Bid</button>
                </form>
        {% endif %}
        <p>{{ message }}</p>
        {% for comment in comments %}
                <p>{{ comment.comment_by}} on {{ comment.listing}} at {{ comment.timestamp }}</p>
        {% endfor %}

{% endblock %}
